@using ApiService
@using ApiService.Helpers
@using ApiService.Models
@inject ApiService ApiService

<h3>Login</h3>

<input @bind="@email" placeholder="email"/>
<input @bind="@haslo" placeholder="haslo"/>

<button @onclick="() => { _ = ZalogujUzytkownika(); }">Zaloguj</button>

@{
    if (isLoading)
    {
        <p>≈Åadowanie...</p>
    }

    if (wynik == null)
    {
        <p></p>
    }
    else
    {
        if (wynik.Error != null)
        {
            <p>Error: @wynik.Error</p>
        }
        else
        {
            <p>Result: </p>
            <p>@wynik.Data?.AccessToken</p>
        }
    }
}

@code {
    string email;
    string haslo;
    Result<Token>? wynik = null;
    bool isLoading = false;

    private async Task ZalogujUzytkownika()
    {
        isLoading = true;
        wynik = await ApiService.AdministracjaRepo.LoginPost(new LoginRequest
        {
            Haslo = haslo,
            Email = email,
        });
        isLoading = false;

        StateHasChanged();
    }

}