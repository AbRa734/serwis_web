@inject IJSRuntime Js
@rendermode InteractiveServer
@using Color = MudBlazor.Color
@using Placement = MudBlazor.Placement
@using Size = MudBlazor.Size

<MudTooltip Text="NarzÄ™dzia WCAG" Placement="Placement.Top">
    <MudFab Color="Color.Primary"
            StartIcon="@Icons.Material.Filled.Help"
            Size="Size.Small"
            OnClick="ToggleMenu" />
</MudTooltip>

@if (showMenu)
{
    <MudPaper Class="pa-2 d-flex flex-column gap-2"
              Style="position: fixed; bottom: 76px; right: 16px; z-index: 1000;">
        <MudButton Variant="Variant.Text" OnClick="IncreaseFont">ğŸ” PowiÄ™ksz czcionkÄ™</MudButton>
        <MudButton Variant="Variant.Text" OnClick="DecreaseFont">ğŸ” Zmniejsz czcionkÄ™</MudButton>
        <MudButton Variant="Variant.Text" OnClick="ToggleContrast">ğŸŒ— Tryb kontrastu</MudButton>
    </MudPaper>
}

@code {
    private bool showMenu = false;
    private int fontSize = 16;
    private bool isHighContrast = false;

    private void ToggleMenu()
    {
        showMenu = !showMenu;
        StateHasChanged();
    }

    private async Task IncreaseFont()
    {
        fontSize += 2;
        await SetFontSize();
    }

    private async Task DecreaseFont()
    {
        fontSize = Math.Max(12, fontSize - 2);
        await SetFontSize();
    }

    private async Task SetFontSize()
    {
        await Js.InvokeVoidAsync("eval", $"document.documentElement.style.setProperty('--mud-typography-default-size', '{fontSize}px')");
        StateHasChanged();
    }

    private async Task ToggleContrast()
    {
        isHighContrast = !isHighContrast;
        await Js.InvokeVoidAsync("eval", $"document.body.classList.{(isHighContrast ? "add" : "remove")}('high-contrast')");
        StateHasChanged();
    }

    protected override void OnInitialized()
    {
        InvokeAsync(async () => await SetFontSize());
    }
}